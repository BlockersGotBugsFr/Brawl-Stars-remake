<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Game Intro Flow</title>
    <style>
      body {
        margin: 0;
        background: black; /* Start with black background for intro */
        font-family: Arial, sans-serif;
        color: white;
        text-align: center;
        transition: background-color 1s ease-in-out, color 1s ease-in-out;
      }

      section {
        display: none;
        height: 100vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
        opacity: 1;
        transition: opacity 1s ease-in-out;
      }

      section.fade-out {
        opacity: 0;
      }

      /* Intro video */
      #intro {
        display: block;
        background: black;
      }

      #intro video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      /* Loading screen */
      #loading {
        display: flex;
        justify-content: center;
        align-items: center;
        background: white;
        color: black;
        font-size: 2rem;
      }

      /* Simple animated dots */
      .dots::after {
        content: '';
        animation: dots 1.5s steps(3, end) infinite;
      }
      @keyframes dots {
        0% { content: ''; }
        33% { content: '.'; }
        66% { content: '..'; }
        100% { content: '...'; }
      }

      /* Lobby */
      #lobby {
        background: white;
        color: black;
        padding-top: 50px;
      }
    </style>
  </head>
  <body>
    <!-- Intro Section -->
    <section id="intro">
      <video id="introVideo" autoplay muted playsinline>
        <source src="lv_0_20250831190250.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </section>

    <!-- Loading Screen -->
    <section id="loading">
      <p>Loading<span class="dots"></span></p>
    </section>

    <!-- Lobby -->
    <section id="lobby">
      <h1>Lobby</h1>
      <p>This is your main area.</p>
    </section>

    <script>
      const intro = document.getElementById("intro");
      const video = document.getElementById("introVideo");
      const loading = document.getElementById("loading");
      const lobby = document.getElementById("lobby");

      // Try autoplay
      video.addEventListener('canplaythrough', () => {
        video.play().catch(error => {
          console.error("Autoplay prevented:", error);
          handleIntroEnd();
        });
      }, { once: true });

      // When intro video ends
      video.onended = () => {
        handleIntroEnd();
      };

      video.addEventListener('error', (e) => {
        console.error("Video loading error:", e);
        handleIntroEnd();
      });

      function handleIntroEnd() {
        // Fade out intro
        intro.classList.add('fade-out');

        intro.addEventListener('transitionend', () => {
          intro.style.display = 'none';
          showLoading();
        }, { once: true });
      }

      function showLoading() {
        loading.style.display = "flex";

        // Stay on loading for 2s, then go to lobby
        setTimeout(() => {
          loading.classList.add("fade-out");
          loading.addEventListener("transitionend", () => {
            loading.style.display = "none";
            lobby.style.display = "block";
          }, { once: true });
        }, 2000);
      }
    </script>
  </body>
</html>
